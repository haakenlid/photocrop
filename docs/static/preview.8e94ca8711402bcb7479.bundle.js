(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var o=t.round=function(e){return Number(e.toPrecision(4))},a=function(e){return(100*e).toFixed(1)+"%"},i=t.normalize=function(e){var t=e.x,r=e.y,n=e.left,o=e.top,a=e.right,i=e.bottom,s=function(e,t){return e-t},l=[0,0,n,a,1,1].sort(s),c=[0,0,o,i,1,1].sort(s);return{x:[0,t,1].sort(s)[1],y:[0,r,1].sort(s)[1],left:l[2],top:c[2],right:l[3],bottom:c[3]}};t.minsize=function(e){return function(t){var r=t.left,n=t.right,o=t.top,a=t.bottom,s=t.x,l=t.y;if(n-r<e){var c=(r+n)/2;r=c-e/2,n=c+e/2}if(a-o<e){var u=(o+a)/2;o=u-e/2,a=u+e/2}return i({x:s,y:l,left:r,right:n,top:o,bottom:a})}},t.getStyles=function(e,t,r,o){var i=function(e,t,r,o,a,i,s){var l=o-r,c=i-a,u=l/c,f=.5*Math.min(s,1,u>s?l:c*s),d=f/s,g=[2*f>l?[f,(r+o)/2,1-f]:[r+f,e,o-f],2*d>c?[d,(a+i)/2,1-d]:[a+d,t,i-d]].map(function(e){return e.sort(function(e,t){return e-t})[1]}),p=n(g,2),v=p[0],y=p[1];return{left:v-f,right:v+f,top:y-d,bottom:y+d}}(t.x,t.y,t.left,t.right,t.top,t.bottom,o/r),s=i.left,l=i.top,c=i.right,u=i.bottom,f=c-s;return{backgroundImage:'url("'+e+'")',backgroundPosition:[[f,c,1],[u-l,u,1]].map(function(e){return function(e,t,r){return r===e?.5:(t-e)/(r-e)}.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e))}).map(a).join(" "),backgroundRepeat:"no-repeat",backgroundSize:a(1/f)+" auto"}},t.getImageSize=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t([n.width,n.height])},n.onerror=r,n.src=e})},t.getRelativePosition=function(e){return function(t){var r=e.getBoundingClientRect(),n=r.left,a=r.top,i=r.width,s=r.height;return[(t.clientX-n)/i,(t.clientY-a)/s].map(function(e,t){return function(r){return Math.max(e,Math.min(r,t))}}(0,1)).map(o)}}},695:function(e,t,r){r(228),r(696),e.exports=r(697)},697:function(e,t,r){"use strict";(function(e){var t=r(513),n=r(710);(0,t.configure)(function(){n.keys().forEach(function(e){return n(e)})},e)}).call(this,r(91)(e))},710:function(e,t,r){var n={"./index.stories.js":711};function o(e){var t=a(e);return r(t)}function a(e){var t=n[e];if(!(t+1)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t}o.keys=function(){return Object.keys(n)},o.resolve=a,e.exports=o,o.id=710},711:function(e,t,r){"use strict";(function(e){var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=f(r(1)),o=r(513),a=r(712),i=f(r(717)),s=f(r(728)),l=f(r(729)),c=f(r(730)),u=f(r(731));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(){return(0,a.select)("Image",{newton:s.default,dragon:l.default,nebuchadnezzar:c.default,urizen:u.default,"no image":"","not found":"404.jpg"},s.default)||void 0},g={x:.5,y:.5,top:.1,bottom:.9,left:.1,right:.9};(0,o.storiesOf)("CropBox",e).addDecorator(a.withKnobs).addDecorator(function(e){return n.default.createElement("div",{style:{height:"100vh"}},e())}).add("crop",function(){return n.default.createElement(i.default,{src:d()})}).add("previews",function(){var e={src:d(),cropBox:(0,a.object)("Crop Box",g),previews:(0,a.object)("Previews",[.5,1,2])};return n.default.createElement(i.default,t({key:JSON.stringify(e)},e))})}).call(this,r(91)(e))},717:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(718));r(723),t.default=n.default},718:function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=d(r(1)),l=r(519),c=d(r(719)),u=d(r(721)),f=d(r(722));function d(e){return e&&e.__esModule?e:{default:e}}var g=function(){return null},p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":n(t))&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.setImageSize=function(){r.setState({size:null}),(0,l.getImageSize)(r.props.src).then(function(e){return r.setState({size:e})}).catch(function(e){return r.setState({error:!0})})},r.state={dragging:null,size:e.size,cropBox:(0,l.normalize)(e.cropBox)},r.elementRef=function(e){return r.element=e},r.imageRef=function(e){return r.getRelativePosition=(0,l.getRelativePosition)(e)},r.onChange=function(){return r.props.onChange(r.state.cropBox)},r.onChanging=function(){return r.props.onChanging(r.state.cropBox)},r.startDragHandleFactory=r.startDragHandleFactory.bind(r),r.eventHandlers={startNewCrop:r.startNewCrop.bind(r),startMoveCross:r.startMoveCross.bind(r),startMoveCropBox:r.startMoveCropBox.bind(r),moveDragHandle:r.moveDragHandle.bind(r),endDragHandle:r.endDragHandle.bind(r),clickInner:r.clickInner.bind(r)},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default.Component),i(t,[{key:"componentDidMount",value:function(){this.setImageSize()}},{key:"startNewCrop",value:function(e){this.element.setPointerCapture(e.pointerId);var t=this.getRelativePosition(e),r=a(t,2),n=r[0],i=r[1],s=this.state.cropBox;this.setState({cropBox:o({},s,{left:n,top:i,right:n,bottom:i}),dragging:{cursor:"move",dragMask:[1,1,0,0,0],initialPosition:[n,i],initialCrop:s}})}},{key:"moveDragHandle",value:function(e){var t,r,n=this.state,i=n.cropBox,s=n.dragging;if(s){var c=this.getRelativePosition(e),u=a(c,2),f=u[0],d=u[1],g=(s.dragMask,a(s.initialPosition,2)),p=g[0],v=g[1],y=s.initialCrop,m=i.x,h=i.y,b=i.left,x=i.top,w=i.right,C=i.bottom,M=a(s.dragMask,5),P=M[0],k=M[1],I=M[2],O=M[3],j=M[4],B=f-p,A=d-v;j&&(m=f),j&&(h=d),P&&(b=f),k&&(x=d),I&&(w=f),O&&(C=d),P&&I&&k&&O&&(b=y.left+B,x=y.top+A,w=y.right+B,C=y.bottom+A),x>C&&(k=(t=[O,k])[0],O=t[1]),b>w&&(P=(r=[I,P])[0],I=r[1]),this.setState({dragging:o({},this.state.dragging,{dragMask:[P,k,I,O,j]}),cropBox:(0,l.normalize)({x:m,y:h,left:b,top:x,right:w,bottom:C}),click:!1}),this.onChanging()}}},{key:"startDragHandleFactory",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"move";return function(n){t.element.setPointerCapture(n.pointerId);var o={dragging:{cursor:r,dragMask:e,initialCrop:t.state.cropBox,initialPosition:t.getRelativePosition(n)}};setTimeout(function(){return t.setState(o)},0)}}},{key:"startMoveCropBox",value:function(e){this.setState({click:!0}),this.startDragHandleFactory([1,1,1,1,0])(e)}},{key:"startMoveCross",value:function(e){this.startDragHandleFactory([0,0,0,0,1])(e)}},{key:"endDragHandle",value:function(e){this.getRelativePosition(e);var t=this.state,r=t.click,n=t.cropBox,o=t.dragging;!r&&o&&(this.setState({cropBox:(0,l.minsize)(.1)(n),dragging:null}),this.onChange())}},{key:"clickInner",value:function(e){var t=this.state,r=t.cropBox;if(t.click){var n=this.getRelativePosition(e),i=a(n,2),s=i[0],c=i[1];this.setState({dragging:!1,click:!1,cropBox:(0,l.normalize)(o({},r,{x:s,y:c}))}),this.onChange()}}},{key:"render",value:function(){var e=this.props,t=e.src,r=e.previews,n=e.Loader,a=this.state,i=a.error,l=a.size,f=a.dragging,d=a.cropBox,g=o({src:t,size:l,dragging:f,cropBox:d,imageRef:this.imageRef,elementRef:this.elementRef,startDragHandleFactory:this.startDragHandleFactory},this.eventHandlers);return l?s.default.createElement("div",{className:"CropBoxContainer"},r.length>0&&s.default.createElement(u.default,{aspects:r,size:l,src:t,cropBox:d}),s.default.createElement(c.default,g)):s.default.createElement("div",{className:"CropBoxContainer"},i&&s.default.createElement(n,{error:!0}))}}]),t}();p.defaultProps={Loader:function(e){var t=e.error;return s.default.createElement("img",{style:{background:t?"red":"black"},src:f.default})},cropBox:{left:.1,right:.9,top:.1,bottom:.9,x:.5,y:.5},src:f.default,previews:[],onChange:g,onChanging:g},t.default=p},719:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(1)),o=a(r(720));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.src,r=e.imageRef,a=e.elementRef,i=(e.error,e.size),s=e.dragging,l=e.cropBox,c=e.moveDragHandle,u=e.endDragHandle,f=e.startNewCrop,d=e.startMoveCross,g=e.startMoveCropBox,p=e.clickInner,v=e.startDragHandleFactory;return n.default.createElement("div",{ref:a,onPointerMove:c,onPointerUp:u,onLostPointerCapture:u,className:"CropBox"},n.default.createElement("svg",{height:"100%",preserveAspectRatio:"xMidYMin",viewBox:"0 0 "+i[0]+" "+i[1]},n.default.createElement("image",{className:"masterImg",xlinkHref:t,ref:r,width:"100%",height:"100%"}),n.default.createElement(o.default,{cropBox:l,size:i,dragging:s,startNewCrop:f,startMoveCross:d,startMoveCropBox:g,startDragHandleFactory:v,clickInner:p})))}},720:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(r(1));var i=new Map([["1000","ew-resize"],["0010","ew-resize"],["0100","ns-resize"],["0001","ns-resize"],["1100","nw-resize"],["0110","ne-resize"],["0011","se-resize"],["1001","sw-resize"]]),s=function(e){var t=e.name,r=e.cursor,n=e.startDragHandleFactory,o=t.split("").map(parseFloat);return a.default.createElement("rect",{className:"Handle",onPointerDown:n(o,r),width:1-o[0]-o[2]+.2,height:1-o[1]-o[3]+.2,x:o[2]-.1,y:o[3]-.1,style:{cursor:r}})},l=function(e){var t=e.x,r=e.y;return a.default.createElement("path",{className:"cross",d:"M0, "+r+"H1M"+t+", 0V1"})};t.default=function(e){var t=e.size,r=e.pending,c=e.cropBox,u=e.startDragHandleFactory,f=e.startMoveCross,d=e.startMoveCropBox,g=e.startNewCrop,p=e.clickInner,v=e.dragging,y=c.left,m=c.x,h=c.right,b=c.top,x=c.y,w=c.bottom,C="M"+y+", "+b+"V"+w+"H"+h+"V"+b+"Z",M=v?{cursor:v.cursor}:{};return a.default.createElement("svg",{style:M},a.default.createElement("svg",{className:"Overlay",viewBox:"0 0 1 1",preserveAspectRatio:"none",height:"100%",width:"100%"},a.default.createElement("path",{className:"outside",fillRule:"evenodd",d:"M0, 0H1V1H0Z"+C,onPointerDown:g}),a.default.createElement("g",{className:"inside"+(r?" pending":"")},a.default.createElement("path",{onClick:p,onPointerDown:d,className:"box",d:C}),v?null:a.default.createElement("svg",{className:"handles",viewBox:"0 0 1 1",preserveAspectRatio:"none",height:w-b,width:h-y,x:y,y:b},Array.from(i).map(function(e){var t=o(e,2),r=t[0],n=t[1];return a.default.createElement(s,{key:r,name:r,cursor:n,startDragHandleFactory:u})}))),a.default.createElement("g",{className:"centerPoint"},v?null:a.default.createElement("ellipse",n({className:"Handle",onPointerDown:f,cx:m,cy:x},function(e){return{rx:e,ry:e*t[0]/t[1]||e}}(.05))),a.default.createElement(l,{x:m,y:x}))))}},721:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(e){return e&&e.__esModule?e:{default:e}}(r(1)),a=r(519);var i=function(e){var t=e.src,r=e.cropBox,n=e.size,i=e.aspect,s=e.style,l=void 0===s?{}:s,c=(0,a.getStyles)(t,r,n[0]/n[1],i);c.backgroundPosition,c.backgroundSize;return o.default.createElement("div",{className:"PreviewImg",style:l},o.default.createElement("svg",{style:c,viewBox:"0 0 "+2*i+" 2"}))};t.default=function(e){var t=e.aspects,r=void 0===t?[2]:t,a=e.flexDirection,s=void 0===a?"row":a,l=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["aspects","flexDirection"]),c=Math.min.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r));return o.default.createElement("div",{className:"CropPreview",style:{flexDirection:s}},r.map(function(e,t){return o.default.createElement(i,n({key:t,aspect:e,style:{flex:e/c}},l))}))}},722:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjAwcHgiIGhlaWdodD0iNDAwcHgiIHZpZXdCb3g9IjAgMCA2MDAgNDAwIiA+CiAgPHN2ZyB3aWR0aD0iNTAlIiB4PSI1MCUiIG92ZXJmbG93PSJ2aXNpYmxlIiB2aWV3Qm94PSIwIDAgMTAwIDgwIiA+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTAgMCkiIGZpbGw9ImJsYWNrIiBvcGFjaXR5PSIwLjQiPiAKICAgICA8cGF0aCAgZD0ibTAgMHY4MGgxMDB2LTgwem05MS45IDcxLjNoLTgzLjR2LTYyLjZoODMuNHoiLz4KICAgICA8cGF0aCAgZD0ibTU2LjEgMjguOWwtMjAuMyAyMS44LTYuOC0zLTE3LjMgMTguOGg3Ni43bC0yMC4zLTMwLTMuOCAyLjItOC4yLTkuOHoiLz4KICAgICA8Y2lyY2xlIHI9IjcuNSIgY3k9IjI0LjUiIGN4PSIzMi44Ii8+IAogICAgPC9nPgogIDwvc3ZnPgo8L3N2Zz4K"},723:function(e,t,r){var n=r(724);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r(726)(n,o);n.locals&&(e.exports=n.locals)},724:function(e,t,r){(e.exports=r(725)(!1)).push([e.i,"body {\n  margin: 0; }\n\n@keyframes marching_ants {\n  0% {\n    stroke-dashoffset: 0; }\n  100% {\n    stroke-dashoffset: 12; } }\n\n.Overlay .inside.pending .box {\n  animation: marching_ants 0.5s steps(10) infinite;\n  stroke-dasharray: 6; }\n\n.Overlay {\n  touch-action: none;\n  overflow: visible;\n  height: 100%;\n  z-index: 10;\n  shape-rendering: auto;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0; }\n  .Overlay path,\n  .Overlay rect,\n  .Overlay ellipse {\n    vector-effect: non-scaling-stroke;\n    fill: transparent; }\n  .Overlay .outside {\n    fill: rgba(0, 0, 0, 0.5); }\n  .Overlay .centerPoint {\n    position: relative; }\n    .Overlay .centerPoint .Handle {\n      cursor: crosshair; }\n      .Overlay .centerPoint .Handle:hover + .cross {\n        stroke: yellow; }\n    .Overlay .centerPoint .cross {\n      pointer-events: none;\n      vector-effect: non-scaling-stroke;\n      stroke: rgba(255, 255, 0, 0.5); }\n  .Overlay .inside .box {\n    stroke: rgba(255, 255, 255, 0.3); }\n  .Overlay .inside:hover .box {\n    stroke: rgba(255, 255, 255, 0.8); }\n  .Overlay .inside.pending .box {\n    stroke: white;\n    stroke-width: 2px; }\n  .Overlay .inside .handles {\n    overflow: visible; }\n  .Overlay .Handle {\n    stroke: blue;\n    stroke-width: 0;\n    fill: red;\n    opacity: 0; }\n    @media (hover: none) {\n      .Overlay .Handle {\n        stroke-width: 1rem; } }\n\n.CropBoxContainer {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%; }\n  .CropBoxContainer .CropBox {\n    display: flex;\n    flex-direction: column; }\n  .CropBoxContainer .CropPreview {\n    flex-shrink: 0;\n    max-height: 50%; }\n\n.CropPreview {\n  display: flex;\n  margin-left: -0.4rem;\n  margin-bottom: 0.4rem; }\n  .CropPreview .PreviewImg {\n    margin-left: 0.4rem; }\n    .CropPreview .PreviewImg > svg {\n      margin: 0 auto;\n      display: block;\n      height: 100%; }\n",""])},728:function(e,t,r){e.exports=r.p+"27d60e6889bf32b93deef9f34b036f75.jpg"},729:function(e,t,r){e.exports=r.p+"24eeeeac275dfaaeda2fb568201201d5.jpg"},730:function(e,t,r){e.exports=r.p+"11f5bb8a6d7d568fb34f2c3565f7bf59.jpg"},731:function(e,t,r){e.exports=r.p+"0021942a19bee31f8ba0dec411e747ac.jpg"}},[[695,3,2]]]);
//# sourceMappingURL=preview.8e94ca8711402bcb7479.bundle.js.map